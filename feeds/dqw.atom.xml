<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>DQW's Blog</title><link href="http://dqw.github.io/" rel="alternate"></link><link href="http://dqw.github.io/feeds/dqw.atom.xml" rel="self"></link><id>http://dqw.github.io/</id><updated>2014-04-23T22:47:00+08:00</updated><entry><title>http和https下的cookie共享</title><link href="http://dqw.github.io/httphe-httpsxia-de-cookiegong-xiang.html" rel="alternate"></link><updated>2014-04-23T22:47:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2014-04-23:httphe-httpsxia-de-cookiegong-xiang.html</id><summary type="html">&lt;h2&gt;起因&lt;/h2&gt;
&lt;p&gt;一天客户提出一个需求，站点的登陆和注销使用https，其它功能还是使用http协议。由于身份认证使用的是SESSION，而识别SESSION需要依靠Cookie中的SESSIONID。其实最根本的问题就是http和https下的Cookie是否可以共享。那么https协议下写入Cookie的SESSIONID，在跳转到http协议后能够正常读取吗？第一反应是不行，因为浏览器有同源策略，那实际情况又是怎么样的呢？&lt;/p&gt;
&lt;h2&gt;实际情况&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;经过测试，当混用http和https时，firefox、chrome、ie8都可以正常读取Cookie&lt;/li&gt;
&lt;li&gt;https协议下，浏览器默认不会加载页面中的http请求(图片会正常加载，js和css不加载)。可以不写明具体的协议只写两个斜杠，即用//代替http://和https://，这样浏览器加载的时候会自动匹配当前页面的协议。这也是&lt;a href="http://google-styleguide.googlecode.com/svn/trunk/htmlcssguide.xml#Protocol"&gt;Google HTML/CSS Style Guide&lt;/a&gt;推荐的方式。 &lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;总结&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Cookie的安全策略和Javascript的同源策略并不完全相同，Cookie只受Domian、Path、Expires、HttpOnly、Secure等属性的影响。&lt;/li&gt;
&lt;li&gt;Cookie的传输并不受端口限制。&lt;/li&gt;
&lt;li&gt;当Cookie属性secure设置为true时，Cookie只能在https中传输，http不会传输。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;参考&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/1612177/are-http-cookies-port-specific"&gt;Are HTTP cookies port specific?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://tools.ietf.org/html/rfc2965"&gt;RFC2965&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href="http://tools.ietf.org/html/rfc6265"&gt;RFC6265&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</summary><category term="http"></category><category term="https"></category><category term="cookie"></category><category term="协议"></category></entry><entry><title>CentOS使用yum安装lamp</title><link href="http://dqw.github.io/centosshi-yong-yuman-zhuang-lamp.html" rel="alternate"></link><updated>2013-10-08T22:47:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-10-08:centosshi-yong-yuman-zhuang-lamp.html</id><summary type="html">&lt;h2&gt;LAMP&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;yum install httpd php php-mysql php-pecl-memcache php-gd php-mbstring php-mcrypt php-cli php-common php-pdo php-pear mysql-server
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;LNMP&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# Nginx源的版本比较新，或者用EPEL源里的也可以但版本比较老
rpm -Uvh http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;安装软件包&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;yum install nginx php-fpm php-mysql php-pecl-memcache php-gd php-mbstring php-mcrypt php-cli php-common php-pdo php-pear mysql-server
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Nginx配置范例&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;conf&lt;/span&gt;&lt;span class="nc"&gt;.d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;default&lt;/span&gt;&lt;span class="nc"&gt;.conf&lt;/span&gt;

&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;The&lt;/span&gt; &lt;span class="nt"&gt;default&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;listen&lt;/span&gt;       &lt;span class="m"&gt;80&lt;/span&gt; &lt;span class="n"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;server_name&lt;/span&gt;  &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="m"&gt;#charse&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="n"&gt;koi8&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="m"&gt;#access&lt;/span&gt;&lt;span class="n"&gt;_log&lt;/span&gt;  &lt;span class="n"&gt;logs&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;access&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;  &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;root&lt;/span&gt;   &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;share&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;index&lt;/span&gt;  &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nt"&gt;error_page&lt;/span&gt;  &lt;span class="nt"&gt;404&lt;/span&gt;              &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;404&lt;/span&gt;&lt;span class="nc"&gt;.html&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;404&lt;/span&gt;&lt;span class="nc"&gt;.html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;root&lt;/span&gt;   &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;share&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;redirect&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="nt"&gt;error&lt;/span&gt; &lt;span class="nt"&gt;pages&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;static&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;50x&lt;/span&gt;&lt;span class="nc"&gt;.html&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;
    &lt;span class="nt"&gt;error_page&lt;/span&gt;   &lt;span class="nt"&gt;500&lt;/span&gt; &lt;span class="nt"&gt;502&lt;/span&gt; &lt;span class="nt"&gt;503&lt;/span&gt; &lt;span class="nt"&gt;504&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;50x&lt;/span&gt;&lt;span class="nc"&gt;.html&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;50x&lt;/span&gt;&lt;span class="nc"&gt;.html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;root&lt;/span&gt;   &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;share&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;proxy&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;PHP&lt;/span&gt; &lt;span class="nt"&gt;scripts&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;Apache&lt;/span&gt; &lt;span class="nt"&gt;listening&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt; &lt;span class="nt"&gt;127&lt;/span&gt;&lt;span class="nc"&gt;.0.0.1&lt;/span&gt;&lt;span class="nd"&gt;:80&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;
    &lt;span class="nf"&gt;#location&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nc"&gt;.php&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;    &lt;span class="n"&gt;proxy_pass&lt;/span&gt;   &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="m"&gt;127&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;pass&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;PHP&lt;/span&gt; &lt;span class="nt"&gt;scripts&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;FastCGI&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="nt"&gt;listening&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt; &lt;span class="nt"&gt;127&lt;/span&gt;&lt;span class="nc"&gt;.0.0.1&lt;/span&gt;&lt;span class="nd"&gt;:9000&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;
    &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nc"&gt;.php&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="m"&gt;#root&lt;/span&gt;           &lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;fastcgi_pass&lt;/span&gt;   &lt;span class="m"&gt;127&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;9000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;fastcgi_index&lt;/span&gt;  &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;这行也要修改为实际路径&lt;/span&gt;
        &lt;span class="n"&gt;fastcgi_param&lt;/span&gt;  &lt;span class="n"&gt;SCRIPT_FILENAME&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;share&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;include&lt;/span&gt;        &lt;span class="n"&gt;fastcgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;deny&lt;/span&gt; &lt;span class="nt"&gt;access&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nc"&gt;.htaccess&lt;/span&gt; &lt;span class="nt"&gt;files&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;if&lt;/span&gt; &lt;span class="nt"&gt;Apache&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s document root&lt;/span&gt;
&lt;span class="s1"&gt;    # concurs with nginx&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt; &lt;span class="nt"&gt;one&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;
    &lt;span class="nf"&gt;#location&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nc"&gt;.ht&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;    &lt;span class="n"&gt;deny&lt;/span&gt;  &lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;手动启动服务&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/etc/init.d/nginx start
/etc/init.d/php-fpm start
/etc/init.d/mysqld start
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;开机自启动&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;chkconfig nginx on
chkconfig php-fpm on
chkconfig mysqld on
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;开放端口&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/sbin/iptables -I INPUT -p tcp --dport 80 -j ACCEPT
/etc/rc.d/init.d/iptables save
&lt;/pre&gt;&lt;/div&gt;</summary><category term="centos"></category><category term="apache"></category><category term="nginx"></category><category term="mysql"></category><category term="php"></category></entry><entry><title>CentOS源码编译安装lnmp</title><link href="http://dqw.github.io/centosyuan-ma-bian-yi-an-zhuang-lnmp.html" rel="alternate"></link><updated>2013-10-08T22:47:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-10-08:centosyuan-ma-bian-yi-an-zhuang-lnmp.html</id><summary type="html">&lt;h2&gt;安装编译环境&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;yum install gcc gcc-c++ automake autoconf libtool make
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;nginx&lt;/h2&gt;
&lt;h3&gt;添加用户&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/usr/sbin/groupadd nginx
/usr/sbin/useradd -g nginx nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;下载源码&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;http://nginx.org/en/download.html
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;nginx编译&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tar xzvf nginx-1.x.tar.gz
./configure --user=nginx --group=nginx --prefix=/usr/local/nginx
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;nginx相关依赖&lt;/h3&gt;
&lt;h4&gt;PCRE&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# 或者用对应源码包安装
yum install pcre-devel
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;zlib&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# 或者用对应源码包安装
yum install zlib-devel
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;启动&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/usr/local/nginx/sbin/nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;服务器启动&lt;/h3&gt;
&lt;h4&gt;拷贝启动脚本到/etc/init.d/nginx&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;http://wiki.nginx.org/RedHatNginxInitScript
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;配置服务自启动&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;chkconfig --add nginx
chkconfig nginx on
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;mysql&lt;/h2&gt;
&lt;h3&gt;下载预编译包&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;http://dev.mysql.com/downloads/mysql/
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;安装&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tar zxvf mysql-x.x.x-linux-glibc2.5-x86.tar.gz
mv mysql-x.x.x-linux-glibc2.5-x86 /usr/local/mysql

# 添加用户
/usr/sbin/groupadd mysql
/usr/sbin/useradd -g mysql mysql

# 建立data目录
mkdir -p /usr/local/mysql/data

# 设置目录权限
chown mysql:mysql /usr/local/mysql

# 安装依赖
yum install libaio

# 初始化数据库
/usr/local/mysql/scripts/mysql_install_db --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --user=mysql
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;设置my.cnf&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;#源码包的support-files/my-default.cnf
[mysqld]
basedir = /usr/local/mysql
datadir = /usr/local/mysql/data
port = 3306
server_id = 10
socket = /tmp/mysql.sock
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;启动&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/usr/local/mysql/bin/mysqld_safe
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;自启动&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cp support-files/mysql.server  /etc/init.d/mysqld
chkconfig --add mysqld
chkconfig mysqld on
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;php&lt;/h2&gt;
&lt;h3&gt;下载源码包&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;http://cn2.php.net/downloads.php
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;php编译安装&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# 安装依赖  
yum install libxml2-devel
yum install libpng-devel

# 编译
./configure --prefix=/usr/local/php --enable-fpm --with-gd --with-pdo-mysql=/usr/local/mysql/ --with-mysqli=/usr/local/mysql/bin/mysql_config --with-config-file-path=/usr/local/php/etc
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;php.ini&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cp php.ini-development /usr/local/php/etc/php.ini
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;php-fpm&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cp sapi/fpm/init.d.php-fpm  /etc/init.d/php-fpm

# 修改php-fpm内容
prefix=/usr/local/php
exec_prefix=/usr/local/php/bin
php_fpm_BIN=/usr/local/php/sbin//php-fpm
php_fpm_CONF=/usr/local/php/etc/php-fpm.conf
php_fpm_PID=/var/run/php-fpm.pid

chmod +x /etc/init.d/php-fpm
chkconfig --add php-fpm
chkconfig php-fpm on
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;apache2&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;http://php.net/manual/zh/install.unix.apache2.php
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;添加用户&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/usr/sbin/groupadd httpd
/usr/sbin/useradd -g httpd
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;下载源码&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;http://www.apache.org
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;apache编译&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;./configure --prefix=/usr/local/httpd
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;apache相关依赖&lt;/h3&gt;
&lt;h4&gt;apr&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# 或者用对应源码包安装(源里的版本可能太低)
yum install apr-devel
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;apr-util&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# 或者用对应源码包安装(源里的版本可能太低)
yum install apr-util-devel
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;编译php&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;./configure --prefix=/usr/local/php --with-apxs2=/usr/local/httpd/bin/apxs --with-gd --with-pdo-mysql=/usr/local/mysql/ --with-mysqli=/usr/local/mysql/bin/mysql_config --with-config-file-path=/usr/local/php/etc
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;修改httpd.conf&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# 添加
&lt;span class="nt"&gt;&amp;lt;FilesMatch&lt;/span&gt; &lt;span class="err"&gt;\.php$&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    SetHandler application/x-httpd-php
&lt;span class="nt"&gt;&amp;lt;/FilesMatch&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;服务器启动&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# 拷贝启动脚本到/etc/init.d
chkconfig --add httpd
chkconfig httpd on

# 修改脚本内容
apachectl=/usr/local/httpd/bin/apachectl
httpd=&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;HTTPD&lt;/span&gt;&lt;span class="o"&gt;-/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;httpd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;httpd&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
prog=httpd
pidfile=&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;PIDFILE&lt;/span&gt;&lt;span class="o"&gt;-/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;httpd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;logs&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;httpd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
lockfile=&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;LOCKFILE&lt;/span&gt;&lt;span class="o"&gt;-/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;subsys&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;httpd&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="centos"></category><category term="apache"></category><category term="nginx"></category><category term="mysql"></category><category term="php"></category></entry><entry><title>MySQL用户授权与密码修改</title><link href="http://dqw.github.io/mysqlyong-hu-shou-quan-yu-mi-ma-xiu-gai.html" rel="alternate"></link><updated>2013-10-08T22:40:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-10-08:mysqlyong-hu-shou-quan-yu-mi-ma-xiu-gai.html</id><summary type="html">&lt;h3&gt;授权&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;GRANT ALL PRIVILEGES ON *.* TO &amp;#39;root&amp;#39;@&amp;#39;192.168.56.%&amp;#39;;
FLUSH PRIVILEGES;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;密码修改&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;USE mysql
UPDATE mysql.user SET Password=PASSWORD(&amp;#39;111111&amp;#39;) WHERE User=&amp;#39;bob&amp;#39; AND Host=&amp;#39;%.example.org&amp;#39;;
FLUSH PRIVILEGES;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="mysql"></category></entry><entry><title>使用Pelican建立Blog</title><link href="http://dqw.github.io/shi-yong-pelicanjian-li-blog.html" rel="alternate"></link><updated>2013-08-19T23:31:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-08-19:shi-yong-pelicanjian-li-blog.html</id><summary type="html">&lt;p&gt;Pelican是用python开发的类似Jekyll静态网站生成工具，支持Markdown、reStructuredText、AsciiDoc等格式，支持RSS输出。&lt;/p&gt;
&lt;h3&gt;安装&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;pip install pelican
pip install Markdown
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;建立Blog&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;mkdir blog
cd blog
pelican-quickstart
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;写文章&lt;/h3&gt;
&lt;p&gt;在content目录建立hello.md&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Title: 文章标题
Date: 2013-08-19
Category: 文章目录
Author: 文章作者
Tag: 标签
Summary: 文章摘要

这里是正文
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;创建页面&lt;/h3&gt;
&lt;p&gt;在content目录创建pages目录，然后创建about.md&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Title: 关于我
Date: 2013-08-19

这里是页面正文
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;生成页面&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;make html
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;使用Disqus评论&lt;/h3&gt;
&lt;p&gt;在Disqus申请, 然后在pelicanconf.py里添加如下内容:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;DISQUS_SITENAME = u&amp;quot;dqw&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;然后重新生成页面&lt;/p&gt;
&lt;h3&gt;更换主题&lt;/h3&gt;
&lt;p&gt;把主题目录拷贝到blog目录，然后在pelicanconf.py里添加如下内容:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;THEME = &amp;#39;gum&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;生成sitemap&lt;/h3&gt;
&lt;p&gt;把pelican-plugins拷贝到blog目录，然后在pelicanconf.py里添加如下内容:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;PLUGIN_PATH = u&amp;quot;pelican-plugins&amp;quot;

PLUGINS = [&amp;quot;sitemap&amp;quot;]

## 配置sitemap 插件
SITEMAP = {
    &amp;quot;format&amp;quot;: &amp;quot;xml&amp;quot;,
    &amp;quot;priorities&amp;quot;: {
        &amp;quot;articles&amp;quot;: 0.7,
        &amp;quot;indexes&amp;quot;: 0.5,
        &amp;quot;pages&amp;quot;: 0.3,
    },
    &amp;quot;changefreqs&amp;quot;: {
        &amp;quot;articles&amp;quot;: &amp;quot;monthly&amp;quot;,
        &amp;quot;indexes&amp;quot;: &amp;quot;daily&amp;quot;,
        &amp;quot;pages&amp;quot;: &amp;quot;monthly&amp;quot;,
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;重新生成页面&lt;/p&gt;
&lt;h3&gt;使用Github的Pages服务托管站点&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;新建一个Repository，Repository名字可以是 xxx.github.io 或者 xxx.github.com，其中 xxx 是您的用户ID。把生成的页面push过去就可以了。
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;绑定域名&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;新建一个名为CNAME的文本文件，里面写入你要绑定的域名，比如www.dqw.me。

如果绑定的是顶级域名，则DNS要新建一条A记录，指向204.232.175.78。如果绑定的是二级域名，则DNS要新建一条CNAME记录，指向username.github.io。
&lt;/pre&gt;&lt;/div&gt;</summary><category term="pelican"></category><category term="github"></category></entry><entry><title>javascript删除数组指定元素</title><link href="http://dqw.github.io/javascriptshan-chu-shu-zu-zhi-ding-yuan-su.html" rel="alternate"></link><updated>2013-01-25T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-01-25:javascriptshan-chu-shu-zu-zhi-ding-yuan-su.html</id><summary type="html">&lt;p&gt;原生javascipt&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;splice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;array&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;jquery&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;var index = $.inArray(value, array);
if (index &amp;gt;= 0) {
   array.splice(index, 1);
}
&lt;/pre&gt;&lt;/div&gt;</summary><category term="javascript"></category><category term="数组"></category></entry><entry><title>MacOS安装homebrew</title><link href="http://dqw.github.io/macosan-zhuang-homebrew.html" rel="alternate"></link><updated>2013-01-25T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-01-25:macosan-zhuang-homebrew.html</id><summary type="html">&lt;p&gt;homebrew是macos下的包管理工具，可以用来安装开源软件，比如apache、mysql等等，类似Debian的apt。比早起的MacPorts要好用，&lt;a href="http://mxcl.github.com/homebrew/"&gt;官方网址&lt;/a&gt;。&lt;/p&gt;
&lt;h3&gt;安装方法&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;mkdir homebrew &amp;amp;&amp;amp; curl -L https://github.com/mxcl/homebrew/tarball/master | tar xz --strip 1 -C homebrew
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;常用命令&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;#查找软件包
brew search python

#安装软件包
brew install python

#列出已安装的软件包
brew list

#删除软件包
brew remove wget

#查看软件包信息
brew info python

#更新brew
brew update

#建立链接
brew link python
&lt;/pre&gt;&lt;/div&gt;</summary><category term="macos"></category><category term="homebrew"></category></entry><entry><title>MacOS安装zim</title><link href="http://dqw.github.io/macosan-zhuang-zim.html" rel="alternate"></link><updated>2013-01-25T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-01-25:macosan-zhuang-zim.html</id><summary type="html">&lt;p&gt;&lt;a href="http://zim-wiki.org/"&gt;zim&lt;/a&gt;是跨平台的桌面wiki软件，主要用来做一些笔记日记用，windows和linux都有现成的安装包，macos下只能用源码安装还是比较麻烦，特意记录一下。&lt;/p&gt;
&lt;p&gt;1、安装Homebrew&lt;/p&gt;
&lt;p&gt;2、安装python&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;brew install python
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;3、安装gobject&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;brew install pygobject
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;4、安装pygtk&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;#会自动安装依赖，gtk+等
brew install pygtk
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;5、链接到/usr/local/bin&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;brew link python
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;6、由于macos自带的python链接到/usr/bin，所以会优先于Homebrew安装的python，所以要改一下path。修改/etc/paths，把/usr/local/bin改到/usr/bin前边。&lt;/p&gt;
&lt;p&gt;7、定义PYTHONPATH&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="x"&gt;vim ~/.bashrc&lt;/span&gt;
&lt;span class="x"&gt;export PYTHONPATH=/usr/local/lib/python2.7/site-packages:&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;PYTHONPATH&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;8、下载并安装下载并安装，&lt;a href="http://www.linuxfromscratch.org/blfs/view/svn/x/hicolor-icon-theme.html"&gt;hicolor-icon-theme&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;#先解压缩
./configure
make &amp;amp;&amp;amp; make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;9、下载zim源码包，然后运行zim.py&lt;/p&gt;</summary><category term="macos"></category><category term="zim"></category></entry><entry><title>VGA线质量不好导致无法调整分辨率</title><link href="http://dqw.github.io/vgaxian-zhi-liang-bu-hao-dao-zhi-wu-fa-diao-zheng-fen-bian-lu.html" rel="alternate"></link><updated>2013-01-25T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2013-01-25:vgaxian-zhi-liang-bu-hao-dao-zhi-wu-fa-diao-zheng-fen-bian-lu.html</id><summary type="html">&lt;p&gt;新换了块独立显卡，安装后分辨率列表没有1920×1080，折腾了一天也没有解决，最后怀疑是我的加长VGA线的问题，更换显示器原厂线解决。原来VGA线质量分好多种，3+4、3+6、3+9、3+11，最少7根线通就能用。但是原来的整合显卡没有问题，具体什么原因不太清楚。&lt;/p&gt;</summary><category term="VGA"></category><category term="分辨率"></category></entry><entry><title>Ubuntu清理无用内核</title><link href="http://dqw.github.io/ubuntuqing-li-wu-yong-nei-he.html" rel="alternate"></link><updated>2012-12-23T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2012-12-23:ubuntuqing-li-wu-yong-nei-he.html</id><summary type="html">&lt;p&gt;buntu12.04用了一段时间了，不断升级，无用的内核一共占用了2G多磁盘空间。&lt;/p&gt;
&lt;p&gt;清理方法一：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo apt-get remove &amp;lt;无用的内核&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;清理方法二：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;直接使用Ubuntu Tweak，现在的Ubuntu Tweak直接有清理无用内核功能，非常方便。
&lt;/pre&gt;&lt;/div&gt;</summary><category term="Ubuntu"></category><category term="分辨率"></category></entry><entry><title>dokuwiki修改缓存文件位置</title><link href="http://dqw.github.io/dokuwikixiu-gai-huan-cun-wen-jian-wei-zhi.html" rel="alternate"></link><updated>2012-04-09T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2012-04-09:dokuwikixiu-gai-huan-cun-wen-jian-wei-zhi.html</id><summary type="html">&lt;p&gt;用网盘同步时可以减少同步的文件，在conf下新建local.protected.php&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_ENV&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TEMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cachedir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/tmp/dokuwiki/cache&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tmpdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/tmp/dokuwiki/tmp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lockdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/tmp/dokuwiki/locks&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/tmp/dokuwiki&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cachedir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tmpdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lockdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cachedir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$_ENV&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TEMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/dokuwiki/cache&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tmpdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$_ENV&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TEMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/dokuwiki/tmp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lockdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$_ENV&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TEMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/dokuwiki/locks&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_ENV&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TEMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/dokuwiki&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cachedir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tmpdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="nb"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$conf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lockdir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="dokuwiki"></category></entry><entry><title>MySQL索引总结</title><link href="http://dqw.github.io/mysqlsuo-yin-zong-jie.html" rel="alternate"></link><updated>2012-01-30T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2012-01-30:mysqlsuo-yin-zong-jie.html</id><summary type="html">&lt;h3&gt;索引简介&lt;/h3&gt;
&lt;p&gt;系统中最频繁的操作应该就是查询操作了，使用索引可快速访问表中的特定信息，提高查询和排序的操作效率。在关系数据库中，索引是一种与表有关的数据库结构，它可以使对应于表的SQL语句执行得更快。 索引的作用相当于图书的目录，可以根据目录中的页码快速找到所需的内容。当表中有大量记录时如果没有索引，查询时需要对表中的记录逐一匹配，这样做会消耗大量数据库系统时间，并造成大量磁盘I/O操作。索引提供指向存储在表的指定列中的数据值的指针，然后根据您指定的排序顺序对这些指针排序。数据库使用索引的方式与书籍中的索引的方式很相似，它搜索索引以找到特定值，然后顺指针找到包含该值的行。&lt;/p&gt;
&lt;h3&gt;MySQL的索引类型&lt;/h3&gt;
&lt;p&gt;1、普通索引&lt;/p&gt;
&lt;p&gt;基本的索引类型，没有唯一性之类的限制，是最常用的索引类型。&lt;/p&gt;
&lt;p&gt;2、唯一性索引&lt;/p&gt;
&lt;p&gt;这种索引和普通索引基本相同，但索引列的所有值都只能出现一次，即必须唯一。&lt;/p&gt;
&lt;p&gt;3、主键&lt;/p&gt;
&lt;p&gt;主键是一种唯一性索引，它必须指定为“PRIMARY KEY”,每个表只能有一个主键，并且不能有null值。&lt;/p&gt;
&lt;h3&gt;主键的选择&lt;/h3&gt;
&lt;p&gt;1)主键的主要作用就是唯一的标识一行，所以主键不应该与业务和逻辑有太多关系。&lt;/p&gt;
&lt;p&gt;2)优先使用自增Integer类型作为主键使用。&lt;/p&gt;
&lt;p&gt;3）尽量避免使用字符类型作为主键，因为字符类型比Integer类型占用更多存储空间，而且排序和查找也比Integer效率低。&lt;/p&gt;
&lt;h3&gt;全文索引Full-text&lt;/h3&gt;
&lt;p&gt;目前MySQL中只有MyISAM存储引擎支持全文索引，而且仅支持CHAR、VARCHAR、TEXT三种数据类型。一般来讲，全文索引用于替代效率低下的LIKE操作。由于全文索引开销比较大，且对中文支持问题在使用时需要提前做好评估。&lt;/p&gt;
&lt;h3&gt;组合索引&lt;/h3&gt;
&lt;p&gt;多个列组合在一起的索引，可以包含15个列，但是会占用更多的存储空间，实际使用时需要根据实际情况做出评估。&lt;/p&gt;
&lt;h3&gt;索引的优点&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;索引可以大幅提高数据的检索速度，数据量越大时，索引的效率越高　　&lt;/li&gt;
&lt;li&gt;主键索引和唯一索引可以保证数据库表中每一行数据的唯一性 　　&lt;/li&gt;
&lt;li&gt;在使用group by和order by检索数据时，可以显著减少查询中分组和排序的时间&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;索引的缺点&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;索引需要占用额外的存储空间，如果有多个组合索引，会占用相当多的磁盘空间，有时索引所占的磁盘空间会比主表还要多。&lt;/li&gt;
&lt;li&gt;在增删改数据时需要额外的开销来维护索引，如果索引较多会对整体性能有比较大的影响。所以使用索引前要对系统的整体进行分析，分析需要建立的表是以查询为主还是以写入为主，然后再决定是否建立索引。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;索引的使用原则和注意事项&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;主要的查询字段和排序字段应该建立索引。&lt;/li&gt;
&lt;li&gt;过滤效果不佳的字段不应该建立索引，通过该字段并不能有效的过滤出较少的数据集合，这时索引并不能发挥出作用，有时甚至比全表扫描还要慢。&lt;/li&gt;
&lt;li&gt;更新过于频繁的字段不应该建立索引，由于表更新时会同时维护索引，如果更新过于频繁，会对整体性能有很大的影响。&lt;/li&gt;
&lt;li&gt;不等比较时不能使用索引，比如’!=’、’ &amp;lt;&amp;gt;‘、 NOT。&lt;/li&gt;
&lt;li&gt;函数或运算后的字段不能使用索引，比如abs(col)、col+1等。&lt;/li&gt;
&lt;li&gt;使用like语句时，以通配符开头不能使用索引，比如LIKE ‘%key’。&lt;/li&gt;
&lt;li&gt;字段类型和关键字类型不统一时，造成的隐式类型转换，可能会使索引失效。比如字段col的类型为字符型，查询语句为 “where col = 123″，这样MySQL会隐式转换类型，无法使用索引，造成查询效率低下。&lt;/li&gt;
&lt;li&gt;由于MySQL Query Optimizer通常只会选择一个索引，索引具体建立索引时需要根据具体的查询情况，分析使用要建立组合索引还是单一索引，哪个字段需要建立索引。并不是把所有的查询字段都建立索引就能提高检索效率，这样不仅浪费了更多的存储空间还有可能使Query Optimizer错误的选择了不合适的索引，造成查询效率低下。&lt;/li&gt;
&lt;li&gt;尽可能使用短的索引字段，可以提高检索效率占用更少的存储空间。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Explain的使用&lt;/h3&gt;
&lt;p&gt;通过使用Explain命令，可以让MySQL Query Optimizer显示出查询语句的执行计划。&lt;/p&gt;
&lt;p&gt;比如：EXPLAIN SELECT * FROM goods WHERE goods_id = 40；执行计划显示这是一个简单查询，使用了主键索引。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;id select_type table type possible_keys key key_len ref rows Extra
1 SIMPLE goods const PRIMARY PRIMARY 4 const 1
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;select_type&lt;/h4&gt;
&lt;p&gt;SIMPLE:简单SELECT(不使用UNION或子查询)&lt;/p&gt;
&lt;p&gt;PRIMARY: 最外面的SELECT&lt;/p&gt;
&lt;p&gt;UNION: UNION中的第二个或后面的SELECT语句&lt;/p&gt;
&lt;p&gt;DEPENDENT UNION: UNION中的第二个或后面的SELECT语句，取决于外面的查询&lt;/p&gt;
&lt;p&gt;UNION RESULT: UNION的结果&lt;/p&gt;
&lt;p&gt;UBQUERY:子查询中的第一个SELECT&lt;/p&gt;
&lt;p&gt;DEPENDENT SUBQUERY:子查询中的第一个SELECT，取决于外面的查询&lt;/p&gt;
&lt;p&gt;DERIVED:导出表的SELECT(FROM子句的子查询)&lt;/p&gt;
&lt;h4&gt;主要的type类型，从优到劣&lt;/h4&gt;
&lt;p&gt;Const:表最多有一个匹配行，它将在查询开始时被读取。因为仅有一行，在这行的列值可被优化器剩余部分认为是常数。Const类型速度很快。&lt;/p&gt;
&lt;p&gt;Eq_ref:最多匹配一条记录，一般通过主键或者唯一索引访问。&lt;/p&gt;
&lt;p&gt;Ref:对于每个来自于前面的表的行组合，所有有匹配索引值的行将从这张表中读取。如果联接只使用键的最左边的前缀，或如果键不是UNIQUE或PRIMARY KEY（换句话说，如果联接不能基于关键字选择单个行的话），则使用ref。如果使用的键仅仅匹配少量行，该联接类型是不错的。&lt;/p&gt;
&lt;p&gt;index_merge:该联接类型表示使用了索引合并优化方法。在这种情况下，key列包含了使用的索引的清单，key_len包含了使用的索引的最长的关键元素。&lt;/p&gt;
&lt;p&gt;Range:索引范围扫描。 只检索给定范围的行，使用一个索引来选择行。key列显示使用了哪个索引。key_len包含所使用索引的最长关键元素。&lt;/p&gt;
&lt;p&gt;Index:全索引扫描。该联接类型与ALL相同，除了只有索引树被扫描。通常比ALL快，因为索引文件通常比数据文件小。&lt;/p&gt;
&lt;p&gt;ALL:全表扫描，没有可用的索引。&lt;/p&gt;
&lt;h4&gt;Possible_keys&lt;/h4&gt;
&lt;p&gt;可以使用的索引列表&lt;/p&gt;
&lt;h4&gt;Key&lt;/h4&gt;
&lt;p&gt;选中使用的索引&lt;/p&gt;
&lt;h4&gt;Key_len&lt;/h4&gt;
&lt;p&gt;索引长度&lt;/p&gt;
&lt;h4&gt;Extra&lt;/h4&gt;
&lt;p&gt;Using filesort:使用了ORDER BY语句但是没有可用索引的时候使用的排序算法，性能会有影响。&lt;/p&gt;
&lt;p&gt;Using index：只需要查询索引即可获取数据是一种比较理想的方式。&lt;/p&gt;
&lt;p&gt;Using temporary：使用了临时表，性能比较差，一般需要优化。&lt;/p&gt;
&lt;h3&gt;使用Profiling 分析查询性能&lt;/h3&gt;
&lt;p&gt;MySQL 5.0.37以上版本提供了MySQL Query Profiler,可以查询到此SQL会执行多少时间,并看出CPU/Memory使用量,执行过程中System lock, Table lock花多少时间等等，Query PRofiler是一个非常方便的Query诊断分析工具，可以用来分析查询语句的性能，分析语句执行过程中的资源消耗情况。&lt;/p&gt;
&lt;p&gt;比如：select * from goods where goods_id &amp;gt;10;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;状态 时间
starting 0.000075
Opening tables 0.000013
System lock 0.000005
Table lock 0.000006
init 0.000044
optimizing 0.000007
statistics 0.000041
preparing 0.000018
executing 0.000002
Sending data 0.000738
end 0.000016
query end 0.000002
freeing items 0.001547
logging slow query 0.000005
cleaning up 0.000006
&lt;/pre&gt;&lt;/div&gt;</summary><category term="MySQL"></category><category term="索引"></category></entry><entry><title>引号对MySQL查询性能的影响</title><link href="http://dqw.github.io/yin-hao-dui-mysqlcha-xun-xing-neng-de-ying-xiang.html" rel="alternate"></link><updated>2012-01-30T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2012-01-30:yin-hao-dui-mysqlcha-xun-xing-neng-de-ying-xiang.html</id><summary type="html">&lt;h3&gt;测试数据&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;CREATE TABLE IF NOT EXISTS `test` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`num` int(11) NOT NULL,
`num_char` varchar(50) NOT NULL,
PRIMARY KEY (`id`),
KEY `num` (`num`),
KEY `num_char` (`num_char`),
) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;插入随机数400000条记录，num和num_char内容一样，只是类型不同。分别建立索引。&lt;/p&gt;
&lt;h3&gt;测试过程&lt;/h3&gt;
&lt;h4&gt;数值字段类型匹配查询&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;EXPLAIN SELECT * FROM `test` WHERE num = 837159
id select_type table type possible_keys key key_len ref rows Extra
1 SIMPLE test ref num num 4 const 12
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;状态 时间
starting 0.000079
Opening tables 0.000014
System lock 0.000005
Table lock 0.000008
init 0.000025
optimizing 0.000008
statistics 0.000055
preparing 0.000013
executing 0.000002
Sending data 0.000371
end 0.000005
query end 0.000002
freeing items 0.000074
logging slow query 0.000002
cleaning up 0.000003
显示行 0 – 12 (13 总计, 查询花费 0.0016 秒)
查询结果正常，正确使用了索引。
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;数值字段类型不匹配查询&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;EXPLAIN SELECT * FROM `test` WHERE num = ’837159′
id select_type table type possible_keys key key_len ref rows Extra
1 SIMPLE test ref num num 4 const 12
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;状态 时间
starting 0.000069
Opening tables 0.000015
System lock 0.000004
Table lock 0.000007
init 0.000024
optimizing 0.000009
statistics 0.000148
preparing 0.000014
executing 0.000002
Sending data 0.000321
end 0.000004
query end 0.000002
freeing items 0.000063
logging slow query 0.000001
cleaning up 0.000003
显示行 0 – 12 (13 总计, 查询花费 0.0011 秒)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;查询结果正常，正确的使用了索引，看来MySQL把查询关键字’837159′隐式转换为了数值类型进行比较。&lt;/p&gt;
&lt;h4&gt;字符字段类型匹配查询&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;EXPLAIN SELECT * FROM `test` WHERE num_char = ’837159′
id select_type table type possible_keys key key_len ref rows Extra
1 SIMPLE test ref num_char num_char 52 const 13 Using where
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;查询结果正常，正确的使用了索引，但是key长度比数值型要长，整体性能肯定比数值型要差。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;状态 时间
starting 0.000197
Opening tables 0.000031
System lock 0.000013
Table lock 0.000017
init 0.000088
optimizing 0.000022
statistics 0.000284
preparing 0.000039
executing 0.000005
Sending data 0.001232
end 0.000017
query end 0.000005
freeing items 0.001041
logging slow query 0.000004
cleaning up 0.000007
显示行 0 – 12 (13 总计, 查询花费 0.0065 秒)
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;字符字段类型不匹配查询&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;EXPLAIN SELECT * FROM `test` WHERE num_char = 837159
id select_type table type possible_keys key key_len ref rows Extra
1 SIMPLE test ALL num_char NULL NULL NULL 400348 Using where
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;状态 时间
starting 0.000072
Opening tables 0.000013
System lock 0.000011
Table lock 0.000008
init 0.000025
optimizing 0.000008
statistics 0.000036
preparing 0.000012
executing 0.000002
Sending data 0.244489
end 0.000008
query end 0.000003
freeing items 0.000095
logging slow query 0.000002
cleaning up 0.000004
显示行 0 – 12 (13 总计, 查询花费 0.2451 秒）
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;查询结果异常，没有正确使用索引，进行了全表扫描。关于这个问题，没有找到合理的解释，分析有可能MySQL把字段的每个值转换为数字然后和关键字进行比较，造成的和索引类型不一致，导致索引失效。并且由于转换带来的开销，使整个查询效率更加低效。&lt;/p&gt;
&lt;h4&gt;特殊情况&lt;/h4&gt;
&lt;p&gt;从测试情况来看，如果字段为数值型，关键字加不加引号似乎影响并不大，但是在一种特殊情况下会有比较大的影响。&lt;/p&gt;
&lt;p&gt;例：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;UPDATE `test` SET num_char = ‘aaa’ WHERE num = ’837159′
13 row(s) affected. ( 查询花费 0.0044 秒 )

update `test` set num_char=’aaa’ WHERE num = ’83715999999′
0 row(s) affected. ( 查询花费 4.2821 秒 )

UPDATE `test` SET num_char = ‘aaa’ WHERE num = 83715999999
0 row(s) affected. ( 查询花费 0.0032 秒 )
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;当进行更新操作时正常情况下没有异常，但是如果数值超出了int的范围加引号的时候就会有相当大的问题。具体为什么出现这种情况还不是很清楚，需要进一步深入分析。&lt;/p&gt;
&lt;h3&gt;总结&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;查询关键字要保证和查询字段类型一致，在类型不一致时MySQL需要进行隐式转换，转换成相同的类型才能进行比较。隐式转换可能会使索引失效，严重影响系统性能。尤其是字段为字符型但是查询关键字没有加引号的情况下，开销相当的巨大。&lt;/li&gt;
&lt;li&gt;如果类型不一致，有一方为数值行，MySQL会优先转换成数值型。&lt;/li&gt;
&lt;li&gt;数值类型的查询效率要比字符型高。&lt;/li&gt;
&lt;li&gt;如果字段为字符型，查询关键字一定要加上引号。&lt;/li&gt;
&lt;li&gt;如果字段为数值型，查询关键字最好不要加引号，虽然只是很小的可能会出现问题，但是性能影响巨大，至于安全隐患可以使用intval函数强制转换来避免。&lt;/li&gt;
&lt;li&gt;总之要避免隐式转换，隐式转换本身会有系统开销，而且会造成不可预知的影响。&lt;/li&gt;
&lt;/ol&gt;</summary><category term="MySQL"></category></entry><entry><title>使用cconv批量简体转繁体</title><link href="http://dqw.github.io/shi-yong-cconvpi-liang-jian-ti-zhuan-fan-ti.html" rel="alternate"></link><updated>2011-11-09T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2011-11-09:shi-yong-cconvpi-liang-jian-ti-zhuan-fan-ti.html</id><summary type="html">&lt;p&gt;cconv是一个批量简繁转换项目，目前只能在linux下使用，&lt;a href="http://code.google.com/p/cconv/"&gt;项目地址&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在ubuntu下安装很简单&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo apt-get install cconv
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;批量转换脚本，最好直接在linux下编辑，windows下编辑后传到linux下可能会出问题&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/sh&lt;/span&gt;
find ./ -type f -name &lt;span class="s2"&gt;&amp;quot;*.php&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;read &lt;/span&gt;line
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$line&lt;/span&gt;
cconv -f UTF8-CN -t UTF8-HK &lt;span class="nv"&gt;$line&lt;/span&gt; -o &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;line&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.zh
&lt;span class="k"&gt;done&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="cconv"></category></entry><entry><title>apache最简单的url rewrite</title><link href="http://dqw.github.io/apachezui-jian-dan-de-url-rewrite.html" rel="alternate"></link><updated>2011-11-06T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2011-11-06:apachezui-jian-dan-de-url-rewrite.html</id><summary type="html">&lt;p&gt;要实现访问rewrite-xxx.html然后重定向到rewrite.php?id=xxx&lt;/p&gt;
&lt;p&gt;1、开启apahce的重定向功能，打开apahce的配置文件，httd.conf&lt;/p&gt;
&lt;p&gt;去掉该行前边的注释&lt;/p&gt;
&lt;p&gt;LoadModule rewrite_module modules/mod_rewrite.so&lt;/p&gt;
&lt;p&gt;把对应的AllowOverride None 改为AllowOverride All&lt;/p&gt;
&lt;p&gt;2、在主机根目录建立一个.htaccess文件写入如下内容&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;IfModule&lt;/span&gt; &lt;span class="err"&gt;mod_rewrite.c&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
RewriteEngine on
RewriteRule ^rewrite-(.*).html$  rewrite.php?id=$1
&lt;span class="nt"&gt;&amp;lt;/IfModule&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;windows下没法直接新建.htaccess文件，可以先建立一个合法的名字比如htaccess.txt，然后用dos命令ren htaccess.txt .htaccess改名就可以了&lt;/p&gt;</summary><category term="apache"></category><category term="rewrite"></category></entry><entry><title>总结php的-&gt;、::、this、self、parent</title><link href="http://dqw.github.io/zong-jie-phpde-this-self-parent.html" rel="alternate"></link><updated>2011-11-06T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2011-11-06:zong-jie-phpde-this-self-parent.html</id><summary type="html">&lt;p&gt;-&amp;gt;用于访问对象的的成员&lt;/p&gt;
&lt;p&gt;::用于访问静态成员(static)，或者直接调用类的成员&lt;/p&gt;
&lt;p&gt;$this用来调用实例化对象的内部成员&lt;/p&gt;
&lt;p&gt;self代表的是类本身，不是任何一个实例化的对象&lt;/p&gt;
&lt;p&gt;parent代表父类&lt;/p&gt;</summary><category term="php"></category></entry><entry><title>mysql replication</title><link href="http://dqw.github.io/mysql-replication.html" rel="alternate"></link><updated>2011-10-19T22:53:00+08:00</updated><author><name>dqw</name></author><id>tag:dqw.github.io,2011-10-19:mysql-replication.html</id><summary type="html">&lt;p&gt;mysql的replication是基于二进制日志的，按照手册配置就可以了，配置很简单&lt;/p&gt;
&lt;h3&gt;主服务器&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;配置文件mysql.ini
[mysqld]
#服务器ID号，整数值，保证唯一标识一台服务器就可以
server-id = 410
#打开二进制日志
log-bin=e:\myoa\logs\mysqlbin.log
#忽略mysql数据库复制
binlog-ignore-db=mysql
#忽略information_schema数据库复制
binlog-ignore-db=information_schema
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;#创建用于复制的账号
GRANT REPLICATION SLAVE ON *.* TO ‘repl’ IDENTIFIED BY ‘slavepass’;
#选择数据库
mysql&amp;gt; use dbname;
#设置表为只读
mysql&amp;gt; FLUSH TABLES WITH READ LOCK；
#备份数据库文件zip
#显示并记录日志文件名和状态，需要在从服务器设置
mysql&amp;gt; SHOW MASTER STATUS;
+—————+———-+————–+——————+
| File          | Position | Binlog_Do_DB | Binlog_Ignore_DB |
+—————+———-+————–+——————+
| mysql-bin.003 | 73       | test         | manual,mysql     |
+—————+———-+————–+——————+
#数据表解锁
mysql&amp;gt; unlock tables;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;从服务器&lt;/h3&gt;
&lt;p&gt;把从主服务器备份的文件在从服务器恢复&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;#设置主服务器信息
mysql&amp;gt; CHANGE MASTER TO
           -&amp;gt;  MASTER_HOST=’192.168.113.128′,
            -&amp;gt;  MASTER_PORT=3306,   
           -&amp;gt;  MASTER_USER=’repl’,
           -&amp;gt;  MASTER_PASSWORD=’slavepass’,
           -&amp;gt;  MASTER_LOG_FILE=’recorded_log_file_name’,
           -&amp;gt;  MASTER_LOG_POS=recorded_log_position;
#启动
mysql&amp;gt; START SLAVE;
#显示状态 查看状态
mysql&amp;gt; Show slave status\G;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;配置文件mysql.ini
mysql.ini
server-id =411
#排除不需要同步的表
replicate_ignore_table=TD_OA.SYS_LOG
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;遇到的问题&lt;/h3&gt;
&lt;p&gt;使用自增字段如果在从服务器写入数据会出现冲突，比如登录日志的表，需要在从服务器排除同步该表&lt;/p&gt;
&lt;p&gt;show master status empty set 服务器端没有配置ini文件&lt;/p&gt;
&lt;p&gt;slave_io_running no 检查端口 log文件名 和便宜量 等一会再观察&lt;/p&gt;
&lt;p&gt;最好主从服务器版本一致&lt;/p&gt;</summary><category term="mysql"></category><category term="replication"></category></entry></feed>